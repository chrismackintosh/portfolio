---
import Base from "../../layouts/Base.astro";
import { withBase } from "../../utils/withBase";
import { getCollection, getEntry } from "astro:content";

// Tell Astro which /writing/<slug>/ pages to build
export async function getStaticPaths() {
  const posts = await getCollection("posts");
  return posts.map((p) => ({ params: { slug: p.slug } }));
}

const slug = Astro.params.slug!;
const entry = await getEntry("posts", slug);
if (!entry) throw new Error(`Post not found: ${slug}`);

const { Content } = await entry.render();
---

<Base title={entry.data.title} description={entry.data.description}>
  <nav class="mb-8">
    <a
      href={withBase("/writing/")}
      class="text-text-mute inline-flex items-center gap-2 text-sm hover:opacity-80"
      aria-label="Back to Writing"
    >
      ‚Üê Back to Writing +
    </a>
  </nav>
  <article class="prose lg:prose-lg">
    <h1 class="mb-0">{entry.data.title}</h1>
    <Content />
  </article>
</Base>
